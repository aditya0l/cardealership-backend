<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase JWT Token Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .config-section { background: #e7f3ff; padding: 20px; border-radius: 5px; margin: 20px 0; }
        .user-section { border: 1px solid #ddd; margin: 15px 0; padding: 15px; border-radius: 5px; }
        .token-output { background: #f8f9fa; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 11px; margin: 10px 0; max-height: 150px; overflow-y: auto; word-break: break-all; }
        button { background: #007bff; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        input { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; width: 250px; }
        .copy-btn { background: #28a745; font-size: 12px; padding: 5px 10px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”¥ Firebase JWT Token Generator</h1>
        <p>Generate JWT tokens for all roles to test your Car Dealership API in Postman</p>

        <div class="config-section">
            <h3>ðŸ”§ Firebase Configuration</h3>
            <p>Enter your Firebase project configuration:</p>
            <input type="text" id="projectId" placeholder="Firebase Project ID" />
            <input type="text" id="apiKey" placeholder="Firebase API Key" />
            <button onclick="initializeFirebase()">Initialize Firebase</button>
            <div id="firebase-status" class="status"></div>
        </div>

        <div id="auth-section" style="display: none;">
            <h2>ðŸ‘¥ Test Users - Generate JWT Tokens</h2>

            <div class="user-section">
                <h3>ðŸ”´ ADMIN</h3>
                <button onclick="signInUser('admin@dealership.com', 'Admin123!', 'admin')">Sign In & Get Token</button>
                <div id="admin-token" class="token-output">Click "Sign In & Get Token" to generate JWT</div>
                <button class="copy-btn" onclick="copyToken('admin-token')">ðŸ“‹ Copy Token</button>
            </div>

            <div class="user-section">
                <h3>ðŸŸ£ GENERAL_MANAGER</h3>
                <button onclick="signInUser('manager@dealership.com', 'Manager123!', 'manager')">Sign In & Get Token</button>
                <div id="manager-token" class="token-output">Click "Sign In & Get Token" to generate JWT</div>
                <button class="copy-btn" onclick="copyToken('manager-token')">ðŸ“‹ Copy Token</button>
            </div>

            <div class="user-section">
                <h3>ðŸ”µ SALES_MANAGER</h3>
                <button onclick="signInUser('sales@dealership.com', 'Sales123!', 'sales')">Sign In & Get Token</button>
                <div id="sales-token" class="token-output">Click "Sign In & Get Token" to generate JWT</div>
                <button class="copy-btn" onclick="copyToken('sales-token')">ðŸ“‹ Copy Token</button>
            </div>

            <div class="user-section">
                <h3>ðŸŸ¢ TEAM_LEAD</h3>
                <button onclick="signInUser('teamlead@dealership.com', 'Lead123!', 'teamlead')">Sign In & Get Token</button>
                <div id="teamlead-token" class="token-output">Click "Sign In & Get Token" to generate JWT</div>
                <button class="copy-btn" onclick="copyToken('teamlead-token')">ðŸ“‹ Copy Token</button>
            </div>

            <div class="user-section">
                <h3>ðŸŸ¡ CUSTOMER_ADVISOR</h3>
                <button onclick="signInUser('advisor@dealership.com', 'Advisor123!', 'advisor')">Sign In & Get Token</button>
                <div id="advisor-token" class="token-output">Click "Sign In & Get Token" to generate JWT</div>
                <button class="copy-btn" onclick="copyToken('advisor-token')">ðŸ“‹ Copy Token</button>
            </div>

            <div class="config-section">
                <h3>ðŸš€ Using Tokens in Postman</h3>
                <ol>
                    <li>Copy the JWT token from above</li>
                    <li>In Postman, go to your environment variables</li>
                    <li>Set <code>firebaseToken</code> = <code>paste-jwt-token-here</code></li>
                    <li>Test protected endpoints with Authorization: <code>Bearer {{firebaseToken}}</code></li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <script>
        let auth = null;

        function initializeFirebase() {
            const projectId = document.getElementById('projectId').value;
            const apiKey = document.getElementById('apiKey').value;
            
            if (!projectId || !apiKey) {
                showStatus('firebase-status', 'Please enter Project ID and API Key', 'error');
                return;
            }

            try {
                const firebaseConfig = {
                    apiKey: apiKey,
                    authDomain: `${projectId}.firebaseapp.com`,
                    projectId: projectId,
                };

                firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                
                showStatus('firebase-status', 'âœ… Firebase initialized successfully!', 'success');
                document.getElementById('auth-section').style.display = 'block';
                
            } catch (error) {
                showStatus('firebase-status', `âŒ Firebase initialization failed: ${error.message}`, 'error');
            }
        }

        async function signInUser(email, password, role) {
            if (!auth) {
                alert('Please initialize Firebase first');
                return;
            }

            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const token = await userCredential.user.getIdToken();
                
                document.getElementById(`${role}-token`).innerHTML = token;
                console.log(`${role.toUpperCase()} Token:`, token);
                
            } catch (error) {
                document.getElementById(`${role}-token`).innerHTML = `Error: ${error.message}`;
                console.error(`Error signing in ${email}:`, error);
            }
        }

        function copyToken(elementId) {
            const tokenElement = document.getElementById(elementId);
            const token = tokenElement.textContent.trim();
            
            if (token && !token.startsWith('Click') && !token.startsWith('Error')) {
                navigator.clipboard.writeText(token).then(() => {
                    alert('Token copied to clipboard!');
                }).catch(err => {
                    console.error('Failed to copy:', err);
                });
            } else {
                alert('No valid token to copy. Please generate token first.');
            }
        }

        function showStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = message;
            element.className = `status ${type}`;
        }
    </script>
</body>
</html>
